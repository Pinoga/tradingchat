<!DOCTYPE html>

<html>
	<head>
		<script>
			function register(form) {
				const el = document.getElementById(form)
				const resMessageEl = document.getElementById(`${form}-error`)
				el.onclick = function(e) {
					e.preventDefault()
					fetch(`api/${form}`, {
						body: new FormData(el),
						method: "post",
						credentials: "same-origin"
					}).then((res) => {
						if (!res.ok) {
							resMessageEl.innerText = "Invalid credentials!"
						}
						if (res.status === 200) {
							window.location.href = "chatroom.html"
						}
					}).catch(err => {
						resMessageEl.innerText = "Connection Error!"
					})
				}
			}
			register("login")
			register("register")
		</script>
	</head>
  <div class="log-form">
    <h2>Welcome to TradingChat!</h2>
    <form id="login"">
      <input type="text" title="username" placeholder="username" />
      <input type="password" title="username" placeholder="password" />
      <button type="button" class="btn">Login</button>
      <span id="login-error"></span>
    </form>
  </div>
  <div class="register-form">
    <h6>If you don't already have an account, you can register here:</h6>
    <form id="register" action="http://localhost:8080/api/register">
      <input type="text" title="username" placeholder="username" />
      <input type="password" title="username" placeholder="password" />
      <button type="button" class="btn">Create account</button>
      <span id="register-error"></span>
    </form>
  </div>
</html>
